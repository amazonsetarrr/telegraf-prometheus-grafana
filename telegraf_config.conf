# ===================================
# Telegraf Configuration
# Cisco, F5, Checkpoint Firewalls
# SNMPv3 + NetFlow (port 9996)
# ===================================

[agent]
  interval = "30s"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  collection_jitter = "5s"
  flush_interval = "30s"
  flush_jitter = "5s"
  hostname = ""
  omit_hostname = false

###############################################################################
# INPUT PLUGINS
###############################################################################

# --- Ping Monitoring ---
[[inputs.ping]]
  urls = [
    "192.168.1.1",   # Cisco
    "192.168.1.2",   # F5
    "192.168.1.3"    # Checkpoint
  ]
  count = 4
  interval = "60s"
  timeout = 2.0
  method = "native"

# --- SNMP Monitoring (SNMPv3) ---
[[inputs.snmp]]
  agents = [
    "udp://192.168.1.1:161",  # Cisco
    "udp://192.168.1.2:161",  # F5
    "udp://192.168.1.3:161"   # Checkpoint
  ]
  version = 3
  sec_name = "snmpuser"             # replace with your SNMPv3 username
  auth_protocol = "SHA"             # options: MD5, SHA
  auth_password = "AuthPassword123" # replace with real password
  sec_level = "authPriv"            # options: noAuthNoPriv, authNoPriv, authPriv
  priv_protocol = "AES"             # options: DES, AES
  priv_password = "PrivPassword123" # replace with real password
  timeout = "5s"
  retries = 3

  name = "snmp"

  [[inputs.snmp.field]]
    name = "uptime"
    oid = "1.3.6.1.2.1.1.3.0"
    is_tag = false

  [[inputs.snmp.field]]
    name = "sysName"
    oid = "1.3.6.1.2.1.1.5.0"
    is_tag = true

  [[inputs.snmp.table]]
    name = "interface"
    inherit_tags = ["sysName"]
    oid = "1.3.6.1.2.1.2.2.1"

    [[inputs.snmp.table.field]]
      name = "ifDescr"
      oid = "1.3.6.1.2.1.2.2.1.2"
      is_tag = true

    [[inputs.snmp.table.field]]
      name = "ifInOctets"
      oid = "1.3.6.1.2.1.2.2.1.10"

    [[inputs.snmp.table.field]]
      name = "ifOutOctets"
      oid = "1.3.6.1.2.1.2.2.1.16"

# --- NetFlow Monitoring (port 9996) ---
[[inputs.netflow]]
  listen = "0.0.0.0:9996"   # NetFlow port
  protocol = "udp"
  version = 9               # supports v5, v9, IPFIX
  read_buffer = 16777216

###############################################################################
# OUTPUT PLUGINS
###############################################################################

# --- Prometheus Output ---
[[outputs.prometheus_client]]
  listen = ":9273"          # Prometheus scrape port
  path = "/metrics"
  expiration_interval = "60s"
  collectors_exclude = ["gocollector", "process"]
